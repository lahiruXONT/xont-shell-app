<!-- Top Navigation Bar -->
<div id="header" class="top-nav-container">
  <div class="container-fluid">
    <div class="navbar">
      <!-- Navbar Header -->
      <div class="navbar-header">
        <!-- Logo for large screens -->
        @if (showLogo) {
        <a class="navbar-brand visible-lg visible-md">
          <img
            src="assets/images/logo-v2.png"
            alt="VENTURA CRM"
            style="width: 185px"
          />
        </a>
        }

        <!-- Business Unit Display -->
        @if (showBusinessUnit && user) {
        <span class="business-unit-display">
          <i class="fa fa-database"></i>
          &nbsp;&nbsp;&nbsp;
          <span class="bu-name">{{ user.currentBusinessUnit }}</span>
        </span>
        }
      </div>

      <!-- Top Nav Menu -->
      <nav id="top-nav" class="navbar-no-collapse" role="navigation">
        <ul class="nav navbar-nav pull-right">
          <!-- Notifications -->
          @if (showNotifications) {
          <li class="dropdown notification-dropdown">
            <a
              href="javascript:void(0)"
              (click)="openNotifications()"
              title="Notifications"
              class="notification-trigger"
            >
              <i class="fa fa-globe" style="font-size: 23px"></i>
              @if (hasUnreadNotifications()) {
              <span class="notificationNumber">
                {{ getNotificationCountDisplay() }}
              </span>
              }
            </a>
            @if (showNotificationsPanel()) {
            <lib-notifications-panel></lib-notifications-panel>
            }
          </li>
          }

          <!-- User Menu -->
          @if (showUserMenu && user) {
          <li class="dropdown user-dropdown">
            <a
              href="javascript:void(0)"
              (click)="toggleUserDropdown()"
              class="user-menu-trigger"
            >
              <img
                class="avatar"
                [src]="userProfile().profileImage"
                (error)="onAvatarError($event)"
                width="36"
                height="36"
                [alt]="userProfile().fullName"
              />
              &nbsp;
              <span class="avatar-name">{{ userProfile().userName }}</span>
              <span class="caret ml5"></span>
            </a>
            <!-- User Dropdown Menu -->
            @if (showUserDropdown()) {
            <ul class="dropdown-menu right" role="menu">
              <!-- Settings -->
              <li>
                <a href="javascript:void(0)" (click)="openSettings()">
                  <i class="im-cog2"></i>
                  Settings
                </a>
              </li>

              <!-- Version Info -->
              <li>
                <a href="javascript:void(0)" (click)="openVersionInfo()">
                  <i class="fa fa-info-circle" style="font-size: 22px"></i>
                  Version Info.
                </a>
              </li>

              <!-- About -->
              <li>
                <a href="javascript:void(0)" (click)="openAbout()">
                  <i class="fa fa-copyright"></i>
                  About
                </a>
              </li>

              <!-- Logout -->
              <li>
                <a href="javascript:void(0)" (click)="onLogout()">
                  <i class="fa fa-power-off"></i>
                  Logout
                </a>
              </li>
            </ul>
            }
          </li>

          <!-- Role/BU Selector -->
          <li class="role-selector-trigger">
            <a
              href="javascript:void(0)"
              (click)="toggleRoleSelector()"
              title="User Roles/Business Unit"
            >
              <i class="fa fa-cogs"></i>
            </a>
            @if (showRoleSelector()) {
            <!-- Role Selector Toggle Button -->
            <lib-role-selector
              [roles]="user.roles"
              [currentRole]="user.currentRole"
              (rolesChanged)="onRolesChanged($event)"
            ></lib-role-selector>
            }
          </li>
          }
        </ul>
      </nav>
    </div>
  </div>
</div>

<!-- Click outside to close dropdowns -->
@if (showUserDropdown() || showRoleSelector() || showNotificationsPanel()) {
<div class="dropdown-backdrop" (click)="closeDropdowns()"></div>
}
