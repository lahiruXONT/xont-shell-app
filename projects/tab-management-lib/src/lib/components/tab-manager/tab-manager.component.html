<lib-tab-tools
  [activeTabId]="activeTabId()"
  [tabCount]="tabs().length"
  [canAddTab]="tabs().length < maxTabs"
  [hasUnsavedTabs]="hasUnsavedTabs()"
  [isMaximized]="maximizedTabId() !== null"
  (refreshClicked)="tabManagerService.refreshTab(activeTabId() || '')"
  (closeActiveClicked)="tabManagerService.closeTab(activeTabId() || '')"
  (closeAllClicked)="tabManagerService.closeAllTabs()"
  (closeOthersClicked)="tabManagerService.closeOtherTabs(activeTabId() || '')"
  (maximizeToggled)="
    maximizedTabId() === activeTabId()
      ? tabManagerService.restoreMaximized()
      : tabManagerService.maximizeTab(activeTabId() || '')
  "
  (minimizeClicked)="tabManagerService.minimizeTab(activeTabId() || '')"
  (fullscreenToggled)="toggleFullscreen()"
  (newTabClicked)="openNewTabDialog()"
  (saveAllClicked)="saveAllUnsavedTabs()"
></lib-tab-tools>

<lib-tab-header
  [tabs]="tabs()"
  [activeTabId]="activeTabId()"
  [minimizedTabs]="minimizedTabs()"
  [maximizedTabId]="maximizedTabId()"
  (tabSelected)="tabManagerService.activateTab($event)"
  (tabClosed)="tabManagerService.closeTab($event)"
  (tabMinimized)="tabManagerService.minimizeTab($event)"
  (tabRestored)="tabManagerService.restoreTab($event)"
  (tabsReordered)="
    tabManagerService.reorderTabs($event.fromIndex, $event.toIndex)
  "
></lib-tab-header>

<div class="tab-content-bed">
  <ng-container *ngFor="let tab of tabs(); trackBy: trackByTab">
    <lib-tab-content
      *ngIf="tab.isActive"
      [tab]="tab"
      [isFullscreen]="maximizedTabId() === tab.id"
      (stateChanged)="onTabStateChanged($event)"
      (titleChanged)="onTabTitleChanged($event)"
      (metadataChanged)="onTabMetadataChanged($event)"
    ></lib-tab-content>
  </ng-container>
</div>
