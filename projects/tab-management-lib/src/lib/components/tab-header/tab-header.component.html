<!-- Tab Header -->
<div
  class="tab-header"
  [class.active]="isActive"
  [class.pinned]="tab.isPinned"
  [class.dirty]="tab.isDirty"
  [class.loading]="tab.state === 'LOADING'"
  [class.error]="tab.state === 'ERROR'"
  (click)="onClick($event)"
  (contextmenu)="onContextMenu($event)"
  [title]="tab.tooltip || tab.title"
>
  <!-- Tab Icon -->
  <div class="tab-icon">
    <i class="fa" [class]="getStateIcon()" [style.color]="getStateColor()"></i>
  </div>

  <!-- Tab Title -->
  <div class="tab-title">
    <span class="title-text">{{ tab.title }}</span>
    @if (tab.isDirty) {
    <span class="dirty-indicator">*</span>
    }
  </div>

  <!-- Pin Indicator -->
  @if (tab.isPinned) {
  <div class="pin-indicator">
    <i class="fa fa-thumbtack"></i>
  </div>
  }

  <!-- Close Button -->
  <button
    class="tab-close-btn"
    (click)="onClose($event)"
    [title]="tab.isPinned ? 'Tab is pinned' : 'Close tab'"
  >
    <i class="fa fa-times"></i>
  </button>
</div>

<!-- Context Menu -->
@if (showContextMenu()) {
<div
  class="tab-context-menu"
  [style.left.px]="contextMenuPosition().x"
  [style.top.px]="contextMenuPosition().y"
>
  <div class="context-menu-item" (click)="onContextAction('refresh', $event)">
    <i class="fa fa-refresh"></i>
    <span>Refresh</span>
  </div>
  <div class="context-menu-item" (click)="onContextAction('pin', $event)">
    <i class="fa fa-thumbtack"></i>
    <span>{{ tab.isPinned ? "Unpin" : "Pin" }} Tab</span>
  </div>
  <div class="context-menu-divider"></div>
  <div
    class="context-menu-item"
    (click)="onContextAction('closeOthers', $event)"
  >
    <i class="fa fa-times-circle"></i>
    <span>Close Others</span>
  </div>
  <div
    class="context-menu-item danger"
    (click)="onContextAction('close', $event)"
  >
    <i class="fa fa-times"></i>
    <span>Close Tab</span>
  </div>
</div>
}
